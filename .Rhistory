scale_x_discrete(expand=c(10,1)) +
scale_shape_manual(values=c(0,1,2)) +
scale_color_manual(values=c('indianred2','deepskyblue3','mediumseagreen')) +
scale_y_continuous(limits=c(0,NA)) +
labs(y=expression(paste('Residual ',{CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
MyTheme +
theme(
axis.text.x= element_blank(),
axis.ticks.x= element_blank())
plot(g_rsd)
g_emi <- g_total + g_sec + g_rsd + plot_layout(widths=c(5,2,1))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
g_sec <- df_emi %>%
filter(Y5==2050, Sc!='Baseline') %>%
mutate(Sv=recode(Sv,Emi_CO2_Ene_Dem_AFO='Emi_CO2_Ene_Dem_Oth_Sec')) %>%
group_by(Sc,Sv,Y5) %>%
summarise(value=sum(value)) %>%
mutate(Sv=factor(Sv,levels=emisec$Sv)) %>%
ggplot() +
geom_bar(aes(x=Sc,y=value/1000,fill=Sv),stat='identity') +
scale_fill_manual(values=plt$Color,labels=plt$Legend,name='Variable') +
guides(fill=guide_legend(reverse=TRUE)) +
labs(y=expression(paste({CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
scale_y_continuous(limits=c(-15,60)) +
geom_hline(yintercept=0,linetype='dashed',color='grey60',size=0.5) +
MyTheme +
theme(
axis.line.y = element_blank(),
axis.text.y= element_blank(),
axis.title.y= element_blank(),
axis.ticks.y = element_blank(),
legend.position = 'none'
)
g_total <- df %>%
filter(Sv=='Emi_CO2_Ene_and_Ind_Pro_inc_Dir_Air',Sc%in%c('Baseline','1.5C w/ Synfuel')) %>%
mutate(Sc=recode(Sc,`1.5C w/ Synfuel`='1.5C')) %>%
group_by(Sc,Y5) %>%
summarise(value=sum(value)) %>%
ggplot() +
geom_path(aes(x=Y5,y=value/1000,color=Sc)) +
labs(y=expression(paste({CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
scale_y_continuous(limits=c(-15,60)) +
geom_hline(yintercept=0,linetype='dashed',color='grey60',size=0.5) +
scale_color_manual(values=c('indianred2','deepskyblue3')) +
MyTheme +
theme(legend.position = c(0.3,0.4))
plot(g_total)
g_sec <- df_emi %>%
filter(Y5==2050, Sc!='Baseline') %>%
mutate(Sv=recode(Sv,Emi_CO2_Ene_Dem_AFO='Emi_CO2_Ene_Dem_Oth_Sec')) %>%
group_by(Sc,Sv,Y5) %>%
summarise(value=sum(value)) %>%
mutate(Sv=factor(Sv,levels=emisec$Sv)) %>%
ggplot() +
geom_bar(aes(x=Sc,y=value/1000,fill=Sv),stat='identity') +
scale_fill_manual(values=plt$Color,labels=plt$Legend,name='Variable') +
guides(fill=guide_legend(reverse=TRUE)) +
labs(y=expression(paste({CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
scale_y_continuous(limits=c(-15,NA)) +
geom_hline(yintercept=0,linetype='dashed',color='grey60',size=0.5) +
MyTheme +
theme(
axis.line.y = element_blank(),
axis.text.y= element_blank(),
axis.title.y= element_blank(),
axis.ticks.y = element_blank(),
legend.position = 'none'
)
g_rsd <- df_emi %>%
filter(Y5==2050, Sc!='Baseline',Sv%in%c('Emi_CO2_Ene_Dem_Ind','Emi_CO2_Ene_Dem_Tra','Emi_CO2_Ene_Dem_Res_and_Com')) %>%
mutate(Sv=recode(Sv,'Emi_CO2_Ene_Dem_Ind'='Industry','Emi_CO2_Ene_Dem_Tra'='Transport','Emi_CO2_Ene_Dem_Res_and_Com'='Buildings')) %>%
mutate(Sv=factor(Sv,levels=c('Industry','Buildings','Transport'))) %>%
ggplot() +
geom_point(aes(x=Sc,y=value/1000,color=Sv,shape=Sc),size=2,stroke=1) +
scale_x_discrete(expand=c(10,1)) +
scale_shape_manual(values=c(0,1,2)) +
scale_color_manual(values=c('indianred2','deepskyblue3','mediumseagreen')) +
scale_y_continuous(limits=c(0,NA)) +
labs(y=expression(paste('Residual ',{CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
MyTheme +
theme(
axis.text.x= element_blank(),
axis.ticks.x= element_blank())
plot(g_rsd)
g_emi <- g_total + g_sec + g_rsd + plot_layout(widths=c(5,2,1))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
g_sec <- df_emi %>%
filter(Y5==2050, Sc!='Baseline') %>%
mutate(Sv=recode(Sv,Emi_CO2_Ene_Dem_AFO='Emi_CO2_Ene_Dem_Oth_Sec')) %>%
group_by(Sc,Sv,Y5) %>%
summarise(value=sum(value)) %>%
mutate(Sv=factor(Sv,levels=emisec$Sv)) %>%
ggplot() +
geom_bar(aes(x=Sc,y=value/1000,fill=Sv),stat='identity') +
scale_fill_manual(values=plt$Color,labels=plt$Legend,name='Variable') +
guides(fill=guide_legend(reverse=TRUE)) +
labs(y=expression(paste({CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
scale_y_continuous(limits=c(-15,NA)) +
geom_hline(yintercept=0,linetype='dashed',color='grey60',size=0.5) +
MyTheme +
theme(
# axis.line.y = element_blank(),
# axis.text.y= element_blank(),
# axis.title.y= element_blank(),
# axis.ticks.y = element_blank(),
legend.position = 'none'
)
g_rsd <- df_emi %>%
filter(Y5==2050, Sc!='Baseline',Sv%in%c('Emi_CO2_Ene_Dem_Ind','Emi_CO2_Ene_Dem_Tra','Emi_CO2_Ene_Dem_Res_and_Com')) %>%
mutate(Sv=recode(Sv,'Emi_CO2_Ene_Dem_Ind'='Industry','Emi_CO2_Ene_Dem_Tra'='Transport','Emi_CO2_Ene_Dem_Res_and_Com'='Buildings')) %>%
mutate(Sv=factor(Sv,levels=c('Industry','Buildings','Transport'))) %>%
ggplot() +
geom_point(aes(x=Sc,y=value/1000,color=Sv,shape=Sc),size=2,stroke=1) +
scale_x_discrete(expand=c(10,1)) +
scale_shape_manual(values=c(0,1,2)) +
scale_color_manual(values=c('indianred2','deepskyblue3','mediumseagreen')) +
scale_y_continuous(limits=c(0,NA)) +
labs(y=expression(paste('Residual ',{CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
MyTheme +
theme(
axis.text.x= element_blank(),
axis.ticks.x= element_blank())
plot(g_rsd)
g_emi <- g_total + g_sec + g_rsd + plot_layout(widths=c(5,2,1))
plot(g_emi)
g_sec <- df_emi %>%
filter(Y5==2050, Sc!='Baseline') %>%
mutate(Sv=recode(Sv,Emi_CO2_Ene_Dem_AFO='Emi_CO2_Ene_Dem_Oth_Sec')) %>%
group_by(Sc,Sv,Y5) %>%
summarise(value=sum(value)) %>%
mutate(Sv=factor(Sv,levels=emisec$Sv)) %>%
ggplot() +
geom_bar(aes(x=Sc,y=value/1000,fill=Sv),stat='identity') +
scale_fill_manual(values=plt$Color,labels=plt$Legend,name='Variable') +
guides(fill=guide_legend(reverse=TRUE)) +
labs(y=expression(paste({CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
# scale_y_continuous(limits=c(-15,60)) +
geom_hline(yintercept=0,linetype='dashed',color='grey60',size=0.5) +
MyTheme +
theme(
# axis.line.y = element_blank(),
# axis.text.y= element_blank(),
# axis.title.y= element_blank(),
# axis.ticks.y = element_blank(),
legend.position = 'none'
)
g_rsd <- df_emi %>%
filter(Y5==2050, Sc!='Baseline',Sv%in%c('Emi_CO2_Ene_Dem_Ind','Emi_CO2_Ene_Dem_Tra','Emi_CO2_Ene_Dem_Res_and_Com')) %>%
mutate(Sv=recode(Sv,'Emi_CO2_Ene_Dem_Ind'='Industry','Emi_CO2_Ene_Dem_Tra'='Transport','Emi_CO2_Ene_Dem_Res_and_Com'='Buildings')) %>%
mutate(Sv=factor(Sv,levels=c('Industry','Buildings','Transport'))) %>%
ggplot() +
geom_point(aes(x=Sc,y=value/1000,color=Sv,shape=Sc),size=2,stroke=1) +
scale_x_discrete(expand=c(10,1)) +
scale_shape_manual(values=c(0,1,2)) +
scale_color_manual(values=c('indianred2','deepskyblue3','mediumseagreen')) +
scale_y_continuous(limits=c(0,NA)) +
labs(y=expression(paste('Residual ',{CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
MyTheme +
theme(
axis.text.x= element_blank(),
axis.ticks.x= element_blank())
plot(g_rsd)
g_emi <- g_total + g_sec + g_rsd + plot_layout(widths=c(5,2,1))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
g_sec <- df_emi %>%
filter(Y5==2050, Sc!='Baseline') %>%
mutate(Sv=recode(Sv,Emi_CO2_Ene_Dem_AFO='Emi_CO2_Ene_Dem_Oth_Sec')) %>%
group_by(Sc,Sv,Y5) %>%
summarise(value=sum(value)) %>%
mutate(Sv=factor(Sv,levels=emisec$Sv)) %>%
ggplot() +
geom_bar(aes(x=Sc,y=value/1000,fill=Sv),stat='identity') +
scale_fill_manual(values=plt$Color,labels=plt$Legend,name='Variable') +
guides(fill=guide_legend(reverse=TRUE)) +
labs(y=expression(paste({CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
scale_y_continuous(limits=c(-15,60)) +
geom_hline(yintercept=0,linetype='dashed',color='grey60',size=0.5) +
MyTheme +
theme(
axis.line.y = element_blank(),
axis.text.y= element_blank(),
axis.title.y= element_blank(),
axis.ticks.y = element_blank(),
legend.position = 'none'
)
g_rsd <- df_emi %>%
filter(Y5==2050, Sc!='Baseline',Sv%in%c('Emi_CO2_Ene_Dem_Ind','Emi_CO2_Ene_Dem_Tra','Emi_CO2_Ene_Dem_Res_and_Com')) %>%
mutate(Sv=recode(Sv,'Emi_CO2_Ene_Dem_Ind'='Industry','Emi_CO2_Ene_Dem_Tra'='Transport','Emi_CO2_Ene_Dem_Res_and_Com'='Buildings')) %>%
mutate(Sv=factor(Sv,levels=c('Industry','Buildings','Transport'))) %>%
ggplot() +
geom_point(aes(x=Sc,y=value/1000,color=Sv,shape=Sc),size=2,stroke=1) +
scale_x_discrete(expand=c(10,1)) +
scale_shape_manual(values=c(0,1,2)) +
scale_color_manual(values=c('indianred2','deepskyblue3','mediumseagreen')) +
scale_y_continuous(limits=c(0,NA)) +
labs(y=expression(paste('Residual ',{CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
MyTheme +
theme(
axis.text.x= element_blank(),
axis.ticks.x= element_blank())
plot(g_rsd)
filter(Y5==2050, Sc!='Baseline') %>%
mutate(Sv=recode(Sv,Emi_CO2_Ene_Dem_AFO='Emi_CO2_Ene_Dem_Oth_Sec')) %>%
group_by(Sc,Sv,Y5) %>%
summarise(value=sum(value)) %>%
mutate(Sv=factor(Sv,levels=emisec$Sv)) %>%
ggplot() +
geom_bar(aes(x=Sc,y=value/1000,fill=Sv),stat='identity') +
scale_fill_manual(values=plt$Color,labels=plt$Legend,name='Variable') +
guides(fill=guide_legend(reverse=TRUE)) +
labs(y=expression(paste({CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
scale_y_continuous(limits=c(-15,60)) +
geom_hline(yintercept=0,linetype='dashed',color='grey60',size=0.5) +
MyTheme +
theme(
axis.line.y = element_blank(),
axis.text.y= element_blank(),
axis.title.y= element_blank(),
axis.ticks.y = element_blank(),
legend.position = 'none'
)
g_sec <- df_emi %>%
filter(Y5==2050, Sc!='Baseline') %>%
mutate(Sv=recode(Sv,Emi_CO2_Ene_Dem_AFO='Emi_CO2_Ene_Dem_Oth_Sec')) %>%
group_by(Sc,Sv,Y5) %>%
summarise(value=sum(value)) %>%
mutate(Sv=factor(Sv,levels=emisec$Sv)) %>%
ggplot() +
geom_bar(aes(x=Sc,y=value/1000,fill=Sv),stat='identity') +
scale_fill_manual(values=plt$Color,labels=plt$Legend,name='Variable') +
guides(fill=guide_legend(reverse=TRUE)) +
labs(y=expression(paste({CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
scale_y_continuous(limits=c(-15,60)) +
geom_hline(yintercept=0,linetype='dashed',color='grey60',size=0.5) +
MyTheme +
theme(
axis.line.y = element_blank(),
axis.text.y= element_blank(),
axis.title.y= element_blank(),
axis.ticks.y = element_blank(),
legend.position = 'none'
)
g_rsd <- df_emi %>%
filter(Y5==2050, Sc!='Baseline',Sv%in%c('Emi_CO2_Ene_Dem_Ind','Emi_CO2_Ene_Dem_Tra','Emi_CO2_Ene_Dem_Res_and_Com')) %>%
mutate(Sv=recode(Sv,'Emi_CO2_Ene_Dem_Ind'='Industry','Emi_CO2_Ene_Dem_Tra'='Transport','Emi_CO2_Ene_Dem_Res_and_Com'='Buildings')) %>%
mutate(Sv=factor(Sv,levels=c('Industry','Buildings','Transport'))) %>%
ggplot() +
geom_point(aes(x=Sc,y=value/1000,color=Sv,shape=Sc),size=2,stroke=1) +
scale_x_discrete(expand=c(10,1)) +
scale_shape_manual(values=c(0,1,2)) +
scale_color_manual(values=c('indianred2','deepskyblue3','mediumseagreen')) +
scale_y_continuous(limits=c(0,NA)) +
labs(y=expression(paste('Residual ',{CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
MyTheme +
theme(
axis.text.x= element_blank(),
axis.ticks.x= element_blank())
plot(g_rsd)
g_emi <- g_total + g_sec + g_rsd + plot_layout(widths=c(5,2,1))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
g_rsd <- df_emi %>%
filter(Y5==2050, Sc!='Baseline',Sv%in%c('Emi_CO2_Ene_Dem_Ind','Emi_CO2_Ene_Dem_Tra','Emi_CO2_Ene_Dem_Res_and_Com')) %>%
mutate(Sv=recode(Sv,'Emi_CO2_Ene_Dem_Ind'='Industry','Emi_CO2_Ene_Dem_Tra'='Transport','Emi_CO2_Ene_Dem_Res_and_Com'='Buildings')) %>%
mutate(Sv=factor(Sv,levels=c('Industry','Buildings','Transport'))) %>%
ggplot() +
geom_point(aes(x=Sv,y=value/1000,color=Sv,shape=Sc),size=2,stroke=1) +
scale_x_discrete(expand=c(10,1)) +
scale_shape_manual(values=c(0,1,2)) +
scale_color_manual(values=c('indianred2','deepskyblue3','mediumseagreen')) +
scale_y_continuous(limits=c(0,NA)) +
labs(y=expression(paste('Residual ',{CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
MyTheme +
theme(
# axis.text.x= element_blank(),
# axis.ticks.x= element_blank()
)
plot(g_rsd)
g_emi <- g_total + g_sec + g_rsd + plot_layout(widths=c(5,2,1))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
g_emi <- g_total + g_sec + g_rsd + plot_layout(widths=c(5,2,2))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
g_rsd <- df_emi %>%
filter(Y5==2050, Sc!='Baseline',Sv%in%c('Emi_CO2_Ene_Dem_Ind','Emi_CO2_Ene_Dem_Tra','Emi_CO2_Ene_Dem_Res_and_Com')) %>%
mutate(Sv=recode(Sv,'Emi_CO2_Ene_Dem_Ind'='Industry','Emi_CO2_Ene_Dem_Tra'='Transport','Emi_CO2_Ene_Dem_Res_and_Com'='Buildings')) %>%
mutate(Sv=factor(Sv,levels=c('Industry','Buildings','Transport'))) %>%
ggplot() +
geom_point(aes(x=Sv,y=value/1000,color=Sv,shape=Sc),size=2,stroke=1) +
# scale_x_discrete(expand=c(10,1)) +
scale_shape_manual(values=c(0,1,2)) +
scale_color_manual(values=c('indianred2','deepskyblue3','mediumseagreen')) +
scale_y_continuous(limits=c(0,NA)) +
labs(y=expression(paste('Residual ',{CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
MyTheme +
theme(
# axis.text.x= element_blank(),
# axis.ticks.x= element_blank()
)
plot(g_rsd)
g_emi <- g_total + g_sec + g_rsd + plot_layout(widths=c(5,2,2))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
l_sec <- g_legend(g_sec+theme(legend.position='left'))
g_emi <- g_total + g_sec + g_rsd + l_sec +plot_layout(widths=c(5,2,2))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
g_emi <- g_total + g_sec + l_sec + g_rsd + plot_layout(widths=c(5,2,1,2))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
g_emi <- g_total + g_sec + l_sec + g_rsd + plot_layout(widths=c(5,2,2,2))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
g_sec <- df_emi %>%
filter(Y5==2050, Sc!='Baseline') %>%
mutate(Sv=recode(Sv,Emi_CO2_Ene_Dem_AFO='Emi_CO2_Ene_Dem_Oth_Sec')) %>%
group_by(Sc,Sv,Y5) %>%
summarise(value=sum(value)) %>%
mutate(Sv=factor(Sv,levels=emisec$Sv)) %>%
ggplot() +
geom_bar(aes(x=Sc,y=value/1000,fill=Sv),stat='identity') +
scale_fill_manual(values=plt$Color,labels=plt$Legend,name='Variable') +
guides(fill=guide_legend(reverse=TRUE)) +
labs(y=expression(paste({CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
scale_y_continuous(limits=c(-15,60)) +
geom_hline(yintercept=0,linetype='dashed',color='grey60',size=0.5) +
MyTheme +
theme(
axis.line.y = element_blank(),
axis.text.y= element_blank(),
axis.title.y= element_blank(),
axis.ticks.y = element_blank(),
legend.position = c(0.4,0.7)
)
g_rsd <- df_emi %>%
filter(Y5==2050, Sc!='Baseline',Sv%in%c('Emi_CO2_Ene_Dem_Ind','Emi_CO2_Ene_Dem_Tra','Emi_CO2_Ene_Dem_Res_and_Com')) %>%
mutate(Sv=recode(Sv,'Emi_CO2_Ene_Dem_Ind'='Industry','Emi_CO2_Ene_Dem_Tra'='Transport','Emi_CO2_Ene_Dem_Res_and_Com'='Buildings')) %>%
mutate(Sv=factor(Sv,levels=c('Industry','Buildings','Transport'))) %>%
ggplot() +
geom_point(aes(x=Sc,y=value/1000,color=Sv,shape=Sc),size=2,stroke=1) +
scale_x_discrete(expand=c(10,1)) +
scale_shape_manual(values=c(0,1,2)) +
scale_color_manual(values=c('indianred2','deepskyblue3','mediumseagreen')) +
scale_y_continuous(limits=c(0,NA)) +
labs(y=expression(paste('Residual ',{CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
MyTheme +
theme(
axis.text.x= element_blank(),
axis.ticks.x= element_blank())
plot(g_rsd)
g_emi <- g_total + g_sec + g_rsd + plot_layout(widths=c(5,2,1))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
filter(Y5==2050, Sc!='Baseline',Sv%in%c('Emi_CO2_Ene_Dem_Ind','Emi_CO2_Ene_Dem_Tra','Emi_CO2_Ene_Dem_Res_and_Com')) %>%
mutate(Sv=factor(Sv,levels=c('Industry','Buildings','Transport'))) %>%
a
g_rsd <- df_emi %>%
filter(Y5==2050, Sc!='Baseline',Sv%in%c('Emi_CO2_Ene_Dem_Ind','Emi_CO2_Ene_Dem_Tra','Emi_CO2_Ene_Dem_Res_and_Com')) %>%
mutate(Sv=recode(Sv,'Emi_CO2_Ene_Dem_Ind'='Industry','Emi_CO2_Ene_Dem_Tra'='Transport','Emi_CO2_Ene_Dem_Res_and_Com'='Buildings')) %>%
mutate(Sv=factor(Sv,levels=c('Industry','Buildings','Transport'))) %>%
ggplot() +
geom_point(aes(x=Sv,y=value/1000,color=Sv,shape=Sc),size=2,stroke=1) +
# scale_x_discrete(expand=c(10,1)) +
scale_shape_manual(values=c(0,1,2)) +
scale_color_manual(values=c('indianred2','deepskyblue3','mediumseagreen')) +
scale_y_continuous(limits=c(0,NA)) +
labs(y=expression(paste('Residual ',{CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
MyTheme +
theme(
# axis.text.x= element_blank(),
# axis.ticks.x= element_blank()
)
plot(g_rsd)
g_emi <- g_total + g_sec + g_rsd + plot_layout(widths=c(5,2,2))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
g_emi <- g_total + g_sec + g_rsd + plot_layout(widths=c(5,2,3))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 5)
g_emi <- g_total + g_sec + g_rsd + plot_layout(widths=c(5,2,3))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 10, height = 5)
g_emi <- g_total + plot_spacer() + g_sec + plot_spacer() +g_rsd + plot_layout(widths=c(5,1,2,1,3))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 10, height = 5)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 4)
ggsave(paste0(odir,'/Fig_emission.png'),width = 9, height = 4.5)
g_emi <- g_total + plot_spacer() + g_sec + plot_spacer() +g_rsd + plot_layout(widths=c(4.5,1,2.5,1,3))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 9, height = 4.5)
g_emi <- g_total + plot_spacer() + g_sec + plot_spacer() +g_rsd + plot_layout(widths=c(4.5,0.5,2.5,0.5,3))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 9, height = 4.5)
g_emi <- {g_total + g_rsd + plot_layout(ncol=1)} + g_sec + plot_layout(widths=c(1,1))
plot(g_emi)
g_emi <- {g_total + g_rsd + plot_layout(ncol=1)} + g_sec + plot_layout(widths=c(1,1),nrow=1)
plot(g_emi)
g_emi <- {g_total + g_rsd + plot_layout(ncol=1)} + g_sec + plot_layout(nrow=1)
plot(g_emi)
g_emi <- {g_total + g_rsd} + g_sec + plot_layout(nrow=1)
plot(g_emi)
g_emi <- {g_total+g_rsd+plot_layout(ncol=1)} + g_sec
plot(g_emi)
g_emi <- g_sec  + {g_total+g_rsd+plot_layout(ncol=1)} + g_sec
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 9, height = 4.5)
g_emi <- plot_spacer() + {g_total+g_rsd+plot_layout(ncol=1)} + g_sec + plot_layout(width=c(0,1,1))
plot(g_emi)
g_sec <- df_emi %>%
filter(Y5==2050, Sc!='Baseline') %>%
mutate(Sv=recode(Sv,Emi_CO2_Ene_Dem_AFO='Emi_CO2_Ene_Dem_Oth_Sec')) %>%
group_by(Sc,Sv,Y5) %>%
summarise(value=sum(value)) %>%
mutate(Sv=factor(Sv,levels=emisec$Sv)) %>%
ggplot() +
geom_bar(aes(x=Sc,y=value/1000,fill=Sv),stat='identity') +
scale_fill_manual(values=plt$Color,labels=plt$Legend,name='Variable') +
guides(fill=guide_legend(reverse=TRUE)) +
labs(y=expression(paste({CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
# scale_y_continuous(limits=c(-15,60)) +
geom_hline(yintercept=0,linetype='dashed',color='grey60',size=0.5) +
MyTheme +
theme(
# axis.line.y = element_blank(),
# axis.text.y= element_blank(),
# axis.title.y= element_blank(),
# axis.ticks.y = element_blank(),
# legend.position = c(0.4,0.7)
)
g_rsd <- df_emi %>%
filter(Y5==2050, Sc!='Baseline',Sv%in%c('Emi_CO2_Ene_Dem_Ind','Emi_CO2_Ene_Dem_Tra','Emi_CO2_Ene_Dem_Res_and_Com')) %>%
mutate(Sv=recode(Sv,'Emi_CO2_Ene_Dem_Ind'='Industry','Emi_CO2_Ene_Dem_Tra'='Transport','Emi_CO2_Ene_Dem_Res_and_Com'='Buildings')) %>%
mutate(Sv=factor(Sv,levels=c('Industry','Buildings','Transport'))) %>%
ggplot() +
geom_point(aes(x=Sv,y=value/1000,color=Sv,shape=Sc),size=2,stroke=1) +
# scale_x_discrete(expand=c(10,1)) +
scale_shape_manual(values=c(0,1,2)) +
scale_color_manual(values=c('indianred2','deepskyblue3','mediumseagreen')) +
scale_y_continuous(limits=c(0,NA)) +
labs(y=expression(paste('Residual ',{CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
MyTheme +
theme(
# axis.text.x= element_blank(),
# axis.ticks.x= element_blank()
)
plot(g_rsd)
g_emi <- plot_spacer() + {g_total+g_rsd+plot_layout(ncol=1)} + g_sec + plot_layout(width=c(0,1,1))
plot(g_emi)
g_total <- df %>%
filter(Sv=='Emi_CO2_Ene_and_Ind_Pro_inc_Dir_Air',Sc%in%c('Baseline','1.5C w/ Synfuel')) %>%
mutate(Sc=recode(Sc,`1.5C w/ Synfuel`='1.5C')) %>%
group_by(Sc,Y5) %>%
summarise(value=sum(value)) %>%
ggplot() +
geom_path(aes(x=Y5,y=value/1000,color=Sc)) +
labs(y=expression(paste({CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
scale_y_continuous(limits=c(-15,60)) +
geom_hline(yintercept=0,linetype='dashed',color='grey60',size=0.5) +
scale_color_manual(values=c('indianred2','deepskyblue3')) +
MyTheme +
theme(legend.position = 'right')
plot(g_total)
g_sec <- df_emi %>%
filter(Y5==2050, Sc!='Baseline') %>%
mutate(Sv=recode(Sv,Emi_CO2_Ene_Dem_AFO='Emi_CO2_Ene_Dem_Oth_Sec')) %>%
group_by(Sc,Sv,Y5) %>%
summarise(value=sum(value)) %>%
mutate(Sv=factor(Sv,levels=emisec$Sv)) %>%
ggplot() +
geom_bar(aes(x=Sc,y=value/1000,fill=Sv),stat='identity') +
scale_fill_manual(values=plt$Color,labels=plt$Legend,name='Variable') +
guides(fill=guide_legend(reverse=TRUE)) +
labs(y=expression(paste({CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
# scale_y_continuous(limits=c(-15,60)) +
geom_hline(yintercept=0,linetype='dashed',color='grey60',size=0.5) +
MyTheme +
theme(
# axis.line.y = element_blank(),
# axis.text.y= element_blank(),
# axis.title.y= element_blank(),
# axis.ticks.y = element_blank(),
# legend.position = c(0.4,0.7)
)
g_rsd <- df_emi %>%
filter(Y5==2050, Sc!='Baseline',Sv%in%c('Emi_CO2_Ene_Dem_Ind','Emi_CO2_Ene_Dem_Tra','Emi_CO2_Ene_Dem_Res_and_Com')) %>%
mutate(Sv=recode(Sv,'Emi_CO2_Ene_Dem_Ind'='Industry','Emi_CO2_Ene_Dem_Tra'='Transport','Emi_CO2_Ene_Dem_Res_and_Com'='Buildings')) %>%
mutate(Sv=factor(Sv,levels=c('Industry','Buildings','Transport'))) %>%
ggplot() +
geom_point(aes(x=Sv,y=value/1000,color=Sv,shape=Sc),size=2,stroke=1) +
# scale_x_discrete(expand=c(10,1)) +
scale_shape_manual(values=c(0,1,2)) +
scale_color_manual(values=c('indianred2','deepskyblue3','mediumseagreen')) +
scale_y_continuous(limits=c(0,NA)) +
labs(y=expression(paste('Residual ',{CO[2]},' emissions (Gt',{CO[2]},' ',{yr^-1},')'))) +
MyTheme +
theme(
# axis.text.x= element_blank(),
# axis.ticks.x= element_blank()
)
plot(g_rsd)
g_emi <- plot_spacer() + {g_total+g_rsd+plot_layout(ncol=1)} + g_sec + plot_layout(width=c(0,1,1))
plot(g_emi)
ggsave(paste0(odir,'/Fig_emission.png'),width = 9, height = 4.5)
ggsave(paste0(odir,'/Fig_emission.png'),width = 8, height = 6)
ggsave(paste0(odir,'/Fig_secene.png'),width=9,height=4)
g <- g_ele + g_hyd + g_ccus + plot_layout(nrow=1)
plot(g)
ggsave(paste0(odir,'/Fig_secene.png'),width=9,height=4)
