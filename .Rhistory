View(serv_GDP_glo)
g <- serv_GDP_glo %>%
filter(Y<=2015) %>%
ggplot() %>%
geom_point(aes(x=GDP,y=serv_t,color=Y))
g <- serv_GDP_glo %>%
filter(Y<=2015) %>%
ggplot() +
geom_point(aes(x=GDP,y=serv_t,color=Y))
plot(g)
serv_GDP_glo <- full_join(serv_glo,ind_glo) %>%
mutate(GDP_CAP=GDP/POP)
g <- serv_GDP_glo %>%
filter(Y<=2015) %>%
ggplot() +
geom_point(aes(x=GDP_CAP,y=serv_t,color=Y))
plot(g)
plot(g)
g <- serv_GDP_glo %>%
filter(Y<=2015) %>%
ggplot() +
geom_point(aes(x=GDP_CAP,y=serv_t,color=Y))
plot(g)
g <- serv_GDP_glo %>%
filter(Y<=2015) %>%
ggplot() +
geom_point(aes(x=POP,y=serv_t,color=Y))
plot(g)
g <- serv_GDP_glo %>%
filter(Y<=2015) %>%
ggplot() +
geom_point(aes(x=GDP,y=serv_t,color=Y))
plot(g)
serv_glo <- serv_t %>%
group_by(Y) %>%
summarize(serv_t=sum(serv_t))
View(serv_t)
serv_shr <- serv_t %>%
filter(Y<=2015)
View(serv_shr)
serv_shr <- serv_t %>%
filter(Y<=2015) %>%
group_by(Y) %>%
mutate(serv_shr=serv_t/sum(serv_t))
hoge <- serv_shr %>%
filter(Y=2005)
hoge <- serv_shr %>%
filter(Y==2005)
View(hoge)
fuga <- sum(hoge$serv_shr)
sum(hoge$serv_shr)
serv_shr <- serv_t %>%
filter(Y<=2015) %>%
group_by(Y) %>%
mutate(serv_shr=serv_t/sum(serv_t))
g <- serv_shr %>%
ggplot() +
geom_point(aes(x=Y,y=serv_shr,color=R33))
plot(g)
g <- serv_shr %>%
ggplot() +
geom_path(aes(x=Y,y=serv_shr,color=R33))
plot(g)
g <- serv_GDP_glo %>%
filter(Y<=2015) %>%
ggplot() +
geom_point(aes(x=GDP,y=serv_t,color=Y))
plot(g)
y <- serv_GDP_glo$serv_t/10000
x <- serv_GDP_gloP$GDP_CAP
plot(x,y)
y <- serv_GDP_glo$serv_t/10000
x <- serv_GDP_glo$GDP_CAP
plot(x,y)
serv_GDP_glo <- full_join(serv_glo,ind_glo) %>%
mutate(GDP_CAP=GDP/POP) %>%
filter(Y<=2015)
y <- serv_GDP_glo$serv_t/10000
x <- serv_GDP_glo$GDP_CAP
plot(x,y)
logisticModel <-  glm(y ~ x, binomial)
y <- serv_GDP_glo$serv_t/50000
x <- serv_GDP_glo$GDP_CAP
plot(x,y)
logisticModel <-  glm(y ~ x, binomial)
summary(logisticModel)
a <- logisticModel$coefficients[1]
b <- logisticModel$coefficients[2]
lineLogistic = function(x) 10000 * exp (a+b*x)/(1+exp(a+b*x))
plot (lineLogistic,0,1000)
y <- serv_GDP_glo$serv_t/50000
x <- serv_GDP_glo$GDP
plot(x,y)
logisticModel <-  glm(y ~ x, binomial)
summary(logisticModel)
a <- logisticModel$coefficients[1]
b <- logisticModel$coefficients[2]
lineLogistic = function(x) 10000 * exp (a+b*x)/(1+exp(a+b*x))
plot (lineLogistic,0,1000)
plot (lineLogistic,0,10000000)
lineLogistic = function(x) 10000 * exp (a+b*x)/(1+exp(a+b*x))
plot (lineLogistic,0,10000000)
plot (lineLogistic,0,10000000000)
lineLogistic = function(x) 10000 * exp (a+b*x)/(1+exp(a+b*x))
plot (lineLogistic,0,10000000000)
fit <- lm(formula=y~x)
fit
sumamry(fit)
summary(fit)
a <- fit$coefficients[1]
b <- fit$coefficients[2]
a <- fit$coefficients[1]
b <- fit$coefficients[2]
g <- serv_GDP %>%
ggplot() +
geom_point(aes(x=GDP_CAP,y=serv_t,color=Y))+
stat_function(fun=lineLogistic)
plot(g)
fit <- lm(formula=y~x)
a <- fit$coefficients[1]
b <- fit$coefficients[2]
plot(line_fit,0,10000)
a <- fit$coefficients[1]
b <- fit$coefficients[2]
line_fit <- function(x) a*x + b
plot(line_fit,0,10000)
g <- serv_GDP_glo %>%
ggplot() +
geom_point(aes(x=GDP,y=serv_t,color=Y)) +
stat_function(fun=line_fit)
plot(g)
serv_GDP_glo <- full_join(serv_glo,ind_glo) %>%
mutate(GDP_CAP=GDP/POP) %>%
filter(Y<=2015)
g <- serv_GDP_glo %>%
ggplot() +
geom_point(aes(x=GDP,y=serv_t,color=Y))
plot(g)
y <- serv_GDP_glo$serv_t
x <- serv_GDP_glo$GDP
fit <- lm(formula=y~x)
a <- fit$coefficients[1]
b <- fit$coefficients[2]
line_fit <- function(x) a*x + b
g <- serv_GDP_glo %>%
ggplot() +
geom_point(aes(x=GDP,y=serv_t,color=Y)) +
stat_function(fun=line_fit)
plot(g)
fit <- lm(formula=y~x)
a <- fit$coefficients[1]
b <- fit$coefficients[2]
line_fit <- function(x) a*x + b
y <- serv_GDP_glo$serv_t
x <- serv_GDP_glo$GDP
plot(x,y)
fit <- lm(formula=y~x)
summary(fit)
a <- fit$coefficients[2]
b <- fit$coefficients[1]
line_fit <- function(x) a*x + b
g <- serv_GDP_glo %>%
ggplot() +
geom_point(aes(x=GDP,y=serv_t,color=Y)) +
stat_function(fun=line_fit)
plot(g)
serv_GDP_glo <- full_join(serv_glo,ind_glo) %>%
mutate(GDP_CAP=GDP/POP)
serv_GDP_glo_2015 <- serv_GDP_glo %>%
filter(Y<=2015)
y <- serv_GDP_glo$serv_t
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
serv_GDP_glo <- full_join(serv_glo,ind_glo) %>%
mutate(GDP_CAP=GDP/POP)
serv_GDP_glo_2015 <- serv_GDP_glo %>%
filter(Y<=2015)
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
plot(x,y)
g <- serv_GDP_glo_2015 %>%
ggplot() +
geom_point(aes(x=GDP,y=serv_t,color=Y)) +
stat_function(fun=line_fit)
plot(g)
serv_GDP_glo
serv_GDP_glo_2100 <- serv_GDP_glo_2015
View(serv_GDP_glo_2100)
serv_GDP_glo_2100 <- serv_GDP_glo_2015 %>%
select(Y,serv_t,GDP)
serv_GDP_glo_2100 <- serv_GDP %>%
select(Y,serv_t,GDP) %>%
serv_GDP_glo_2100 <- serv_GDP %>%
select(Y,serv_t,GDP)
serv_GDP_glo <- full_join(serv_glo,ind_glo) %>%
mutate(GDP_CAP=GDP/POP)
serv_GDP_glo_2100 <- serv_GDP %>%
select(Y,serv_t,GDP)
View(serv_GDP_glo)
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP)
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t=if_else(Y>2015,line_fit(GDP),serv_t))
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t2=if_else(Y>2015,line_fit(GDP),serv_t))
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t=if_else(Y>2015,line_fit(GDP),serv_t))
g <- serv_GDP_glo_2100 %>%
ggplot()+
geom_point(aes(x=Y,y=serv_t))
plot(g)
g <- ind_t %>%
ggplot()+
geom_point(aes(x=Y,y=GDP_MER))
plot(g)
View(ind_t)
g <- ind_glo %>%
ggplot()+
geom_point(aes(x=Y,y=GDP_MER))
plot(g)
g <- ind_glo %>%
ggplot()+
geom_point(aes(x=Y,y=GDP))
plot(g)
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
plot(x,y)
g <- serv_GDP_glo_2015 %>%
ggplot() +
geom_point(aes(x=GDP,y=serv_t,color=Y)) +
stat_function(fun=line_fit)
plot(g)
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t=if_else(Y>2015,line_fit(GDP),serv_t))
g <- serv_GDP_glo_2100 %>%
ggplot()+
geom_point(aes(x=Y,y=serv_t))
plot(g)
g <- serv_GDP_glo_2100 %>%
ggplot()+
geom_point(aes(x=Y,y=serv_t))+
scale_y_continuous(limits=c(0,NA))
plot(g)
# middle demand
y <- serv_GDP_glo_2015$serv_t/1e+05
x <- serv_GDP_glo_2015$GDP
fit_h <-  glm(y ~ x, binomial)
# middle demand
y <- serv_GDP_glo_2015$serv_t/1e+05
x <- serv_GDP_glo_2015$GDP
fit_h <-  glm(y ~ x, binomial)
a <- fit_h$coefficients[1]
b <- fit_h$coefficients[2]
# high demand
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
fit <- lm(formula=y~x)
summary(fit)
a <- fit$coefficients[2]
b <- fit$coefficients[1]
line_fit_high <- function(x) a*x + b
# middle demand
y <- serv_GDP_glo_2015$serv_t/1e+05
x <- serv_GDP_glo_2015$GDP
fit_m <-  glm(y ~ x, binomial)
a <- fit_m$coefficients[1]
b <- fit_m$coefficients[2]
fit_line_middle <-  function(x) 10000 * exp (a+b*x)/(1+exp(a+b*x))
g <- serv_GDP_glo_2015 %>%
ggplot() +
geom_point(aes(x=GDP,y=serv_t,color=Y)) +
stat_function(fun=line_fit)
plot(g)
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t=if_else(Y>2015,line_fit_high(GDP),serv_t))
mutate(serv_t=if_else(Y>2015,line_fit_middle(GDP),serv_t))
g <- serv_GDP_glo_2015 %>%
ggplot() +
geom_point(aes(x=GDP,y=serv_t,color=Y)) +
stat_function(fun=line_fit_high)
plot(g)
g <- serv_GDP_glo_2015 %>%
ggplot() +
geom_point(aes(x=GDP,y=serv_t,color=Y)) +
stat_function(fun=line_fit_high)
plot(g)
# high demand
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
fit <- lm(formula=y~x)
summary(fit)
a <- fit$coefficients[2]
b <- fit$coefficients[1]
line_fit_high <- function(x) a*x + b
# high demand
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
fit <- lm(formula=y~x)
summary(fit)
a <- fit$coefficients[2]
b <- fit$coefficients[1]
line_fit_high <- function(x) a*x + b
# middle demand
y <- serv_GDP_glo_2015$serv_t/1e+05
x <- serv_GDP_glo_2015$GDP
fit_m <-  glm(y ~ x, binomial)
a <- fit_m$coefficients[1]
b <- fit_m$coefficients[2]
fit_line_middle <-  function(x) 10000 * exp (a+b*x)/(1+exp(a+b*x))
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t=if_else(Y>2015,line_fit_high(GDP),serv_t))
mutate(serv_t=if_else(Y>2015,line_fit_middle(GDP),serv_t))
rv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP)
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP)
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t=if_else(Y>2015,line_fit_high(GDP),serv_t))
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t=if_else(Y>2015,line_fit_high(GDP),serv_t)) %>%
mutate(serv_t=if_else(Y>2015,line_fit_middle(GDP),serv_t))
# middle demand
y <- serv_GDP_glo_2015$serv_t/1e+05
x <- serv_GDP_glo_2015$GDP
fit_m <-  glm(y ~ x, binomial)
a <- fit_m$coefficients[1]
b <- fit_m$coefficients[2]
fit_line_middle <-  function(x) 10000 * exp (a+b*x)/(1+exp(a+b*x))
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t=if_else(Y>2015,line_fit_high(GDP),serv_t)) %>%
mutate(serv_t=if_else(Y>2015,line_fit_middle(GDP),serv_t))
line_fit_middle <-  function(x) 10000 * exp (a+b*x)/(1+exp(a+b*x))
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t=if_else(Y>2015,line_fit_high(GDP),serv_t)) %>%
mutate(serv_t=if_else(Y>2015,line_fit_middle(GDP),serv_t))
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t_high=if_else(Y>2015,line_fit_high(GDP),serv_t)) %>%
mutate(serv_t_midddle=if_else(Y>2015,line_fit_middle(GDP),serv_t))
# high demand
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
fit <- lm(formula=y~x)
summary(fit)
a <- fit$coefficients[2]
b <- fit$coefficients[1]
line_fit_high <- function(x) a*x + b
# middle demand
y <- serv_GDP_glo_2015$serv_t/1e+05
x <- serv_GDP_glo_2015$GDP
fit_m <-  glm(y ~ x, binomial)
a <- fit_m$coefficients[1]
b <- fit_m$coefficients[2]
line_fit_middle <-  function(x) 10000 * exp (a+b*x)/(1+exp(a+b*x))
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t_high=if_else(Y>2015,line_fit_high(GDP),serv_t)) %>%
mutate(serv_t_midddle=if_else(Y>2015,line_fit_middle(GDP),serv_t))
# high demand
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
fit <- lm(formula=y~x)
summary(fit)
serv_GDP_glo_2015 <- serv_GDP_glo %>%
filter(Y<=2015)
# high demand
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
fit <- lm(formula=y~x)
summary(fit)
a <- fit$coefficients[2]
b <- fit$coefficients[1]
line_fit_high <- function(x) a*x + b
# high demand
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
fit <- lm(formula=y~x)
summary(fit)
a <- fit$coefficients[2]
b <- fit$coefficients[1]
line_fit_high <- function(x) a*x + b
# middle demand
y <- serv_GDP_glo_2015$serv_t/1e+05
x <- serv_GDP_glo_2015$GDP
fit_m <-  glm(y ~ x, binomial)
a <- fit_m$coefficients[1]
b <- fit_m$coefficients[2]
line_fit_middle <-  function(x) 10000 * exp (a+b*x)/(1+exp(a+b*x))
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t_high=if_else(Y>2015,line_fit_high(GDP),serv_t)) %>%
mutate(serv_t_midddle=if_else(Y>2015,line_fit_middle(GDP),serv_t))
line_fit_high <- function(x) a*x + b
plot(line_fit_high,0,1000)
View(serv_GDP_glo_2015)
# high demand
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
fit <- lm(formula=y~x)
summary(fit)
plot(x,y)
fit <- lm(formula=y~x)
summary(fit)
a <- fit$coefficients[2]
b <- fit$coefficients[1]
line_fit_high <- function(x) a*x + b
plot(line_fit_high,0,1000)
# middle demand
y <- serv_GDP_glo_2015$serv_t/1e+05
x <- serv_GDP_glo_2015$GDP
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
plot(x,y)
fit <- lm(formula=y~x)
summary(fit)
a <- fit$coefficients[2]
b <- fit$coefficients[1]
line_fit_high <- function(x) a*x + b
plot(line_fit_high,0,1000)
# middle demand
y <- serv_GDP_glo_2015$serv_t/1e+05
x <- serv_GDP_glo_2015$GDP
fit_m <-  glm(y ~ x, binomial)
a <- fit_m$coefficients[1]
b <- fit_m$coefficients[2]
line_fit_middle <-  function(x) 10000 * exp (a+b*x)/(1+exp(a+b*x))
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t_high=if_else(Y>2015,line_fit_high(GDP),serv_t)) %>%
mutate(serv_t_midddle=if_else(Y>2015,line_fit_middle(GDP),serv_t))
y <- serv_GDP_glo_2015$serv_t
x <- serv_GDP_glo_2015$GDP
plot(x,y)
fit <- lm(formula=y~x)
summary(fit)
a <- fit$coefficients[2]
b <- fit$coefficients[1]
line_fit_high <- function(x) a*x + b
plot(line_fit_high,0,1000)
# middle demand
y <- serv_GDP_glo_2015$serv_t/1e+05
x <- serv_GDP_glo_2015$GDP
fit_m <-  glm(y ~ x, binomial)
a2 <- fit_m$coefficients[1]
b2 <- fit_m$coefficients[2]
line_fit_middle <-  function(x) 10000 * exp (a2+b2*x)/(1+exp(a2+b2*x))
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t_high=if_else(Y>2015,line_fit_high(GDP),serv_t)) %>%
mutate(serv_t_midddle=if_else(Y>2015,line_fit_middle(GDP),serv_t))
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t_high=if_else(Y>2015,line_fit_high(GDP),serv_t)) %>%
mutate(serv_t_midddle=if_else(Y>2015,line_fit_middle(GDP),serv_t)) %>%
pivot_longer(cols=c(Y,GDP),names_to="Scenario",values_to="Value")
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t_high=if_else(Y>2015,line_fit_high(GDP),serv_t)) %>%
mutate(serv_t_midddle=if_else(Y>2015,line_fit_middle(GDP),serv_t)) %>%
pivot_longer(cols=-c(Y,GDP),names_to="Scenario",values_to="serv_t")
g <- serv_GDP_glo_2100 %>%
ggplot()+
geom_point(aes(x=Y,y=serv_t,color=Scenario))+
scale_y_continuous(limits=c(0,NA))
plot(g)
plot(line_fit_high,0,1000000)
plot(line_fit_high,0,100000)
plot(line_fit_high,0,100000)
plot(line_fit_middle,0,100000)
plot(line_fit_middle,0,100000000)
plot(line_fit_middle,0,100000000000)
plot(line_fit_middle,0,1000000000)
# middle demand
y <- serv_GDP_glo_2015$serv_t/1e+06
x <- serv_GDP_glo_2015$GDP
fit_m <-  glm(y ~ x, binomial)
a2 <- fit_m$coefficients[1]
b2 <- fit_m$coefficients[2]
line_fit_middle <-  function(x) 10000 * exp (a2+b2*x)/(1+exp(a2+b2*x))
plot(line_fit_middle,0,1000000000)
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t_high=if_else(Y>2015,line_fit_high(GDP),serv_t)) %>%
mutate(serv_t_midddle=if_else(Y>2015,line_fit_middle(GDP),serv_t)) %>%
pivot_longer(cols=-c(Y,GDP),names_to="Scenario",values_to="serv_t")
g <- serv_GDP_glo_2100 %>%
ggplot()+
geom_point(aes(x=Y,y=serv_t,color=Scenario))+
scale_y_continuous(limits=c(0,NA))
plot(g)
line_fit_middle <-  function(x) 100000 * exp (a2+b2*x)/(1+exp(a2+b2*x))
plot(line_fit_middle,0,1000000000)
serv_GDP_glo_2100 <- serv_GDP_glo %>%
select(Y,serv_t,GDP) %>%
mutate(serv_t_high=if_else(Y>2015,line_fit_high(GDP),serv_t)) %>%
mutate(serv_t_midddle=if_else(Y>2015,line_fit_middle(GDP),serv_t)) %>%
pivot_longer(cols=-c(Y,GDP),names_to="Scenario",values_to="serv_t")
g <- serv_GDP_glo_2100 %>%
ggplot()+
geom_point(aes(x=Y,y=serv_t,color=Scenario))+
scale_y_continuous(limits=c(0,NA))
plot(g)
